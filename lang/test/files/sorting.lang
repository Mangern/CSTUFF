// https://open.kattis.com/problems/magicsequence

arr: int[1000000];

quick_sort: (l: int, r: int) -> void = {
    if (l >= r) {
        return;
    }

    p := arr[r];
    i := l - 1;
    j := l;

    while (j < r) {
        if (arr[j] <= p) {
            i += 1;
            t := arr[j];
            arr[j] = arr[i];
            arr[i] = t;
        }
        j += 1;
    }

    t := arr[i+1];
    arr[i+1] = arr[r];
    arr[r] = t;

    quick_sort(l, i);
    quick_sort(i + 2, r);
}

main: () -> void = {
    n := 1000000;
    a := 501234;
    b := 15432;
    c := 1251532;
    x := 757387;
    y := 3712091;

    // ANSWER: 2841809

    i := 1;

    arr[0] = a;

    while (i < n) {
        arr[i] = ((arr[i-1] * b) % c + a) % c;
        i += 1;
    }

    quick_sort(0, n - 1);

    v: int = 0;

    i = 0;

    while (i < n) {
        v = ((v * x) % y + arr[i]) % y;
        i += 1;
    }

    println(v);
}
